# ржорзЗржорзЛрж░рж┐ рж╣рж╛ржпрж╝рж╛рж░рж╛рж░рзНржХрж┐
## Chapter 07: Memory Hierarchy

---

## ЁЯУМ ржорзЗржорзЛрж░рж┐ рж╣рж╛ржпрж╝рж╛рж░рж╛рж░рзНржХрж┐ ржХрзА?

ржорзЗржорзЛрж░рж┐ рж╣рж╛ржпрж╝рж╛рж░рж╛рж░рзНржХрж┐ рж╣рж▓рзЛ ржмрж┐ржнрж┐ржирзНржи рж╕рзНрждрж░рзЗрж░ ржорзЗржорзЛрж░рж┐рж░ рж╕ржВржЧржаржи ржпрзЗржЦрж╛ржирзЗ ржЧрждрж┐, ржзрж╛рж░ржгржХрзНрж╖ржорждрж╛ ржУ ржорзВрж▓рзНржпрзЗрж░ ржоржзрзНржпрзЗ ржнрж╛рж░рж╕рж╛ржорзНржп рж░ржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржпрж╝ред

```
                    тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
                    тФВ RegisterтФВ тЖР ржжрзНрж░рзБрждрждржо, ржХрзНрж╖рзБржжрзНрж░рждржо
                    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
                    тФВ L1 CacheтФВ
                    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
                    тФВ L2 CacheтФВ
                    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
                    тФВ L3 CacheтФВ
                    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
                    тФВ   RAM   тФВ
                    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
                    тФВ   SSD   тФВ
                    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
                    тФВ   HDD   тФВ тЖР ржзрзАрж░рждржо, ржмрзГрж╣рждрзНрждржо
                    тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
        ржЧрждрж┐ ржмрзГржжрзНржзрж┐ тЦ▓               тЦ╝ ржзрж╛рж░ржгржХрзНрж╖ржорждрж╛ ржмрзГржжрзНржзрж┐
```

---

## ЁЯУК ржорзЗржорзЛрж░рж┐ рждрзБрж▓ржирж╛

| рж╕рзНрждрж░ | ржЖржХрж╛рж░ | ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрж╛ржЗржо | ржЦрж░ржЪ/GB |
|------|-------|----------------|--------|
| Register | ~1 KB | 0.5 ns | - |
| L1 Cache | 32-64 KB | 1-2 ns | ржЕрждрзНржпржзрж┐ржХ |
| L2 Cache | 256 KB-1 MB | 4-10 ns | ржмрзЗрж╢рж┐ |
| L3 Cache | 8-64 MB | 20-40 ns | ржорж╛ржЭрж╛рж░рж┐ |
| RAM | 8-64 GB | 60-100 ns | $5-10 |
| SSD | 256 GB-4 TB | 100 ╬╝s | $0.1 |
| HDD | 1-16 TB | 5-10 ms | $0.02 |

---

## ЁЯОп Locality of Reference

### Temporal Locality (рж╕ржоржпрж╝ржЧржд рж╕рзНржерж╛ржирзАржпрж╝рждрж╛)
рж╕ржорзНржкрзНрж░рждрж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛ ржбрж╛ржЯрж╛ рж╢рзАржШрзНрж░ржЗ ржЖржмрж╛рж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ рж╣ржУржпрж╝рж╛рж░ рж╕ржорзНржнрж╛ржмржирж╛ ржмрзЗрж╢рж┐ред

```c
// Loop variable 'i' ржмрж╛рж░ржмрж╛рж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ рж╣ржпрж╝
for (int i = 0; i < 1000; i++) {
    sum += i;
}
```

### Spatial Locality (рж╕рзНржерж╛ржирж┐ржХ рж╕рзНржерж╛ржирзАржпрж╝рждрж╛)
ржкрж╛рж░рзНрж╢рзНржмржмрж░рзНрждрзА ржорзЗржорзЛрж░рж┐ рж▓рзЛржХрзЗрж╢ржи ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ рж╣ржУржпрж╝рж╛рж░ рж╕ржорзНржнрж╛ржмржирж╛ ржмрзЗрж╢рж┐ред

```c
// Array ржПрж░ ржкрж╛рж╢рж╛ржкрж╛рж╢рж┐ ржЙржкрж╛ржжрж╛ржи
for (int i = 0; i < 1000; i++) {
    sum += array[i];
}
```

---

## ЁЯТ╛ RAM ржПрж░ ржкрзНрж░ржХрж╛рж░

### SRAM (Static RAM)
- Flip-flops ржжрж┐ржпрж╝рзЗ рждрзИрж░рж┐
- ржжрзНрж░рзБржд ржЧрждрж┐
- ржмрзЗрж╢рж┐ power, ржмрзЗрж╢рж┐ ржЦрж░ржЪ
- Cache memory рждрзЗ ржмрзНржпржмрж╣рзГржд
- No refresh ржкрзНрж░ржпрж╝рзЛржЬржи

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ     SRAM Cell (6 Transistors)   тФВ
тФВ                                  тФВ
тФВ    тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР    тФВ
тФВ    тФВ   Cross-coupled       тФВ    тФВ
тФВ    тФВ   Inverters           тФВ    тФВ
тФВ    тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ    тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
```

### DRAM (Dynamic RAM)
- Capacitor + Transistor
- ржзрзАрж░ ржЧрждрж┐
- ржХржо power, ржХржо ржЦрж░ржЪ
- Main memory рждрзЗ ржмрзНржпржмрж╣рзГржд
- Refresh ржкрзНрж░ржпрж╝рзЛржЬржи

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ     DRAM Cell (1T1C)            тФВ
тФВ                                  тФВ
тФВ    тФМтФАтФАтФАтФР     тФМтФАтФАтФАтФР              тФВ
тФВ    тФВ T тФВтФАтФАтФАтФАтФАтФВ C тФВ              тФВ
тФВ    тФФтФАтФАтФАтФШ     тФФтФАтФАтФАтФШ              тФВ
тФВ  Transistor  Capacitor          тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
```

### SRAM vs DRAM

| ржмрзИрж╢рж┐рж╖рзНржЯрзНржп | SRAM | DRAM |
|----------|------|------|
| ржЧрждрж┐ | ржжрзНрж░рзБржд | ржзрзАрж░ |
| ржШржирждрзНржм | ржХржо | ржмрзЗрж╢рж┐ |
| ржЦрж░ржЪ | ржмрзЗрж╢рж┐ | ржХржо |
| Power | ржмрзЗрж╢рж┐ | ржХржо |
| Refresh | ржирж╛ | рж╣рзНржпрж╛ржБ |
| ржмрзНржпржмрж╣рж╛рж░ | Cache | Main Memory |

---

## ЁЯФД DRAM ржПрж░ ржкрзНрж░ржХрж╛рж░

### SDR SDRAM
- Single Data Rate
- Clock ржПрж░ rising edge ржП ржбрж╛ржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░

### DDR SDRAM
- Double Data Rate
- Rising ржУ falling edge ржП ржбрж╛ржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░

### DDR ржкрзНрж░ржЬржирзНржо

| ржкрзНрж░ржЬржирзНржо | ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ рж░рзЗржЯ | ржнрзЛрж▓рзНржЯрзЗржЬ |
|---------|---------------|---------|
| DDR3 | 800-2133 MT/s | 1.5V |
| DDR4 | 2133-3200 MT/s | 1.2V |
| DDR5 | 4800-8400 MT/s | 1.1V |

---

## ЁЯП╖я╕П ROM ржПрж░ ржкрзНрж░ржХрж╛рж░

### ROM (Read-Only Memory)
- ржкрзНрж░рзЛржЧрзНрж░рж╛ржо рж╕рзНржерж╛ржпрж╝рзАржнрж╛ржмрзЗ рж╕ржВрж░ржХрзНрж╖рж┐ржд
- Power off рж╣рж▓рзЗржУ ржбрж╛ржЯрж╛ ржерж╛ржХрзЗ

| ржкрзНрж░ржХрж╛рж░ | ржмрж░рзНржгржирж╛ |
|--------|--------|
| ROM | Factory programmed |
| PROM | ржПржХржмрж╛рж░ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо ржХрж░рж╛ ржпрж╛ржпрж╝ |
| EPROM | UV light ржжрж┐ржпрж╝рзЗ ржорзЛржЫрж╛ ржпрж╛ржпрж╝ |
| EEPROM | Electrically erasable |
| Flash | Block-wise erase |

---

## ЁЯУР ржорзЗржорзЛрж░рж┐ рж╕ржВржЧржаржи

### Word Size
- 32-bit system: 4 bytes per word
- 64-bit system: 8 bytes per word

### Byte Ordering

```
Little Endian (Intel):
Address:  0x100  0x101  0x102  0x103
Value:     78     56     34     12
          (LSB)                (MSB)

Big Endian (Network):
Address:  0x100  0x101  0x102  0x103
Value:     12     34     56     78
          (MSB)                (LSB)
```

### Memory Interleaving
- ржПржХрж╛ржзрж┐ржХ memory bank рж╕ржорж╛ржирзНрждрж░рж╛рж▓рзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕
- Bandwidth ржмрзГржжрзНржзрж┐

---

## тЬПя╕П ржЕржирзБрж╢рзАрж▓ржирзА

1. Locality of Reference ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рзБржиред
2. SRAM ржУ DRAM ржПрж░ ржкрж╛рж░рзНржержХрзНржп рж▓рж┐ржЦрзБржиред
3. DDR4 ржУ DDR5 ржПрж░ рждрзБрж▓ржирж╛ ржХрж░рзБржиред

---

## ЁЯУЪ ржкрж░ржмрж░рзНрждрзА ржЕржзрзНржпрж╛ржпрж╝
[ржХрзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐](./02-ржХрзНржпрж╛рж╢-ржорзЗржорзЛрж░рж┐.md)
