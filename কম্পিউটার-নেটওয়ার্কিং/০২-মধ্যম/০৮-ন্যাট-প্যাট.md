# NAT এবং PAT (NAT & PAT)

## 📖 NAT কী?

**NAT (Network Address Translation)** হলো Private IP কে Public IP তে (বা উল্টো) রূপান্তর করার প্রক্রিয়া।

### কেন দরকার?

```
IPv4 Address সীমিত: প্রায় 4.3 বিলিয়ন
পৃথিবীতে Device: 20+ বিলিয়ন!

সমাধান:
- বাসায়/অফিসে Private IP ব্যবহার
- ইন্টারনেটে যাওয়ার সময় NAT করে Public IP ব্যবহার
```

### সহজ উদাহরণ

```
আপনার বাসা:
PC1: 192.168.1.10 ─┐
PC2: 192.168.1.11 ─┼─→ [Router/NAT] ─→ Internet
PC3: 192.168.1.12 ─┘   (Public: 203.0.113.5)

বাইরে থেকে দেখলে সবাই 203.0.113.5!
```

---

## 🏠 Private vs Public IP (রিভিউ)

### Private IP Ranges

| Class | Range | সাধারণ ব্যবহার |
|-------|-------|---------------|
| A | 10.0.0.0 - 10.255.255.255 | বড় Enterprise |
| B | 172.16.0.0 - 172.31.255.255 | মাঝারি |
| C | 192.168.0.0 - 192.168.255.255 | বাসা/ছোট অফিস |

### Private IP বৈশিষ্ট্য

```
✓ ফ্রি - কেউ দেয় না, নিজে ব্যবহার করুন
✓ Non-routable - ইন্টারনেটে সরাসরি যায় না
✓ Reusable - সব বাসায় 192.168.1.x ব্যবহার হয়
✗ NAT ছাড়া Internet access নেই
```

---

## 🔄 NAT এর প্রকারভেদ

### ১. Static NAT (1:1)

```
একটি Private IP = একটি Public IP

Internal              External
192.168.1.10  ←→  203.0.113.10
192.168.1.11  ←→  203.0.113.11
192.168.1.12  ←→  203.0.113.12
```

| সুবিধা | অসুবিধা |
|--------|---------|
| Inbound connection সহজ | প্রতি device এ Public IP লাগে |
| Server publish করা যায় | Scalable না |

**ব্যবহার:** Web server, Mail server publish

---

### ২. Dynamic NAT (Many:Many)

```
Pool থেকে Public IP বরাদ্দ হয়

Internal              Pool              External
192.168.1.10  →  [203.0.113.10]  →  Internet
192.168.1.11  →  [203.0.113.11]  →  Internet
192.168.1.12  →  [Available]

Pool শেষ হলে নতুন connection হয় না!
```

| সুবিধা | অসুবিধা |
|--------|---------|
| 1:1 mapping দরকার না | Pool exhausted হতে পারে |
| কিছুটা scalable | এখনো অনেক Public IP লাগে |

---

### ৩. PAT / NAT Overload (Many:1) ⭐ সবচেয়ে বেশি ব্যবহৃত

```
অনেক Private IP = একটি Public IP
Port number দিয়ে আলাদা করা হয়

Internal                          External
192.168.1.10:51234  ─┐
192.168.1.11:51235  ─┼─→ 203.0.113.5:xxxxx ─→ Internet
192.168.1.12:51236  ─┘

একটাই Public IP, কিন্তু হাজার হাজার device!
```

| সুবিধা | অসুবিধা |
|--------|---------|
| শুধু ১টি Public IP লাগে | Inbound connection কঠিন |
| খুবই scalable | Port forwarding দরকার |
| Home router এ standard | কিছু protocol সমস্যা |

---

## 📊 PAT কীভাবে কাজ করে

### Outbound (বাইরে যাওয়া)

```
Step 1: PC Request
┌────────────────────────────────────────┐
│ Source: 192.168.1.10:51234             │
│ Dest:   8.8.8.8:53 (DNS)               │
└────────────────────────────────────────┘
                ↓
Step 2: Router NAT করে
┌────────────────────────────────────────┐
│ Source: 203.0.113.5:30001              │ ← Public IP + নতুন Port
│ Dest:   8.8.8.8:53                     │
└────────────────────────────────────────┘
                ↓
Step 3: NAT Table এ সেভ
┌─────────────────────────────────────────────────────────────┐
│                    NAT Translation Table                     │
├───────────────────────┬─────────────────────────────────────┤
│ Inside Local          │ Inside Global                        │
├───────────────────────┼─────────────────────────────────────┤
│ 192.168.1.10:51234    │ 203.0.113.5:30001                   │
│ 192.168.1.11:51235    │ 203.0.113.5:30002                   │
│ 192.168.1.12:51236    │ 203.0.113.5:30003                   │
└───────────────────────┴─────────────────────────────────────┘
```

### Inbound (ভিতরে আসা)

```
Step 1: Reply আসলো
┌────────────────────────────────────────┐
│ Source: 8.8.8.8:53                     │
│ Dest:   203.0.113.5:30001              │
└────────────────────────────────────────┘
                ↓
Step 2: Router NAT Table দেখে
"30001 → 192.168.1.10:51234"
                ↓
Step 3: Translate করে PC তে পাঠায়
┌────────────────────────────────────────┐
│ Source: 8.8.8.8:53                     │
│ Dest:   192.168.1.10:51234             │
└────────────────────────────────────────┘
```

---

## 🚪 Port Forwarding (DNAT)

### সমস্যা: বাইরে থেকে ভিতরে ঢুকতে চাই

```
ইন্টারনেট থেকে কেউ আপনার Web server এ আসতে চায়।
কিন্তু আপনার server Private IP তে!

203.0.113.5 এ request → কোথায় যাবে?
```

### সমাধান: Port Forward

```
Router Config:
Public IP:Port → Private IP:Port
203.0.113.5:80 → 192.168.1.100:80

এখন:
Internet → 203.0.113.5:80 → Router → 192.168.1.100:80 (Web Server)
```

### ডায়াগ্রাম

```
                   Internet
                       │
                       ↓
              ┌────────────────┐
              │     Router     │
              │ NAT/Port Fwd   │
              │                │
              │ :80 → .100:80  │
              │ :22 → .101:22  │
              └────────┬───────┘
                       │
         ┌─────────────┼─────────────┐
         ↓             ↓             ↓
    [Web Server]  [SSH Server]  [PC]
    192.168.1.100 192.168.1.101 192.168.1.10
```

---

## 🏷️ NAT Terminology

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│   Inside Network              │           Outside Network       │
│   (আপনার LAN)                  │           (Internet)            │
│                               │                                  │
│   ┌──────────┐    ┌─────────────────────┐    ┌──────────┐      │
│   │   PC     │    │       Router        │    │  Server  │      │
│   │          │    │                     │    │          │      │
│   │ Inside   │───→│ Inside   │  Outside │───→│ Outside  │      │
│   │ Local    │    │ Global   │  Local   │    │ Global   │      │
│   │192.168.1.10   │203.0.113.5│ 8.8.8.8  │    │ 8.8.8.8  │      │
│   └──────────┘    └─────────────────────┘    └──────────┘      │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

| Term | মানে |
|------|------|
| Inside Local | Device এর real Private IP |
| Inside Global | NAT করা Public IP |
| Outside Local | বাইরের IP (local perspective) |
| Outside Global | বাইরের device এর real IP |

---

## ⚠️ NAT এর সুবিধা ও অসুবিধা

### সুবিধা ✅

| সুবিধা | ব্যাখ্যা |
|--------|---------|
| IP conservation | কম Public IP লাগে |
| Security (sort of) | Internal structure লুকানো |
| Flexibility | Internal addressing change করলে outside affect হয় না |

### অসুবিধা ❌

| অসুবিধা | ব্যাখ্যা |
|---------|---------|
| End-to-end broken | Direct connection সমস্যা |
| Protocol issues | SIP, FTP active mode সমস্যা |
| Troubleshooting | Complex debugging |
| Performance | CPU overhead |

---

## 🔧 বাস্তব উদাহরণ: Home Router

### আপনার বাসার NAT

```
ISP দিয়েছে: 103.x.x.x (Public IP)

বাসায়:
- PC:     192.168.0.100
- Phone:  192.168.0.101  
- TV:     192.168.0.102
- Laptop: 192.168.0.103

সবাই 103.x.x.x হিসেবে internet এ যায় (PAT)
```

### Port Forward Setup (সাধারণত Router Admin)

```
Application    External Port    Internal IP      Internal Port
────────────────────────────────────────────────────────────
Web Server     80               192.168.0.50     80
Minecraft      25565            192.168.0.50     25565
SSH            2222             192.168.0.100    22
```

---

## 🧪 NAT Troubleshooting

### Issue 1: Can't connect from outside
```
Check:
✓ Port forwarding সঠিক?
✓ Internal server চালু?
✓ Firewall ব্লক করছে?
✓ ISP port block করে?
```

### Issue 2: Some apps don't work
```
VoIP/Video call issue?
→ NAT traversal problem
→ UPnP enable করুন
→ STUN/TURN server ব্যবহার
```

### NAT Type (Gaming)

```
NAT Type 1 (Open): সব কাজ করে
NAT Type 2 (Moderate): বেশিরভাগ কাজ করে
NAT Type 3 (Strict): অনেক সমস্যা

Strict NAT → Port forward করে improve করুন
```

---

## 📊 NAT Types Summary

| Type | Ratio | Use Case |
|------|-------|----------|
| Static NAT | 1:1 | Server hosting |
| Dynamic NAT | Many:Many | বড় organization |
| PAT (Overload) | Many:1 | Home/Office (সবচেয়ে common) |

---

## ✏️ অনুশীলনী

### ১. প্রশ্নের উত্তর দিন
```
a) আপনার বাসার router কোন ধরনের NAT করে?
b) Port forwarding কেন দরকার?
c) NAT কি firewall? কেন/কেন না?
```

### ২. সিচুয়েশন
```
আপনার বাসায় একটি Web server আছে:
- Server IP: 192.168.1.50
- Router Public IP: 203.0.113.10

বাইরে থেকে access করতে কী করবেন?
```

### ৩. Troubleshoot
```
Port forward করেছেন কিন্তু বাইরে থেকে access হচ্ছে না।
কী কী চেক করবেন?
```

---

## 🎓 পরবর্তী পাঠ

Intermediate level শেষ! এখন Advanced level এ যাবো:
- [অ্যাডভান্সড রাউটিং প্রোটোকল](../03-advanced/??-???????????-??????.md)

---

**🔙 [পূর্ববর্তী: DNS এবং DHCP](./??-??????-?????????.md)** | **🔜 [পরবর্তী: অ্যাডভান্সড রাউটিং](../03-advanced/??-???????????-??????.md)**


