# ফায়ারওয়াল (Firewall)

## 📖 Firewall কী?

**Firewall** হলো একটি network security device যা incoming এবং outgoing traffic monitor করে এবং predefined rules অনুযায়ী allow বা block করে।

```
                        🔥 FIREWALL 🔥
                              ║
        INTERNET              ║              INTERNAL NETWORK
                              ║
    ┌─────────┐    Block ✗    ║     Allow ✓    ┌─────────┐
    │ Hacker  │────────────×──╢───────────────→│   PC    │
    └─────────┘               ║                └─────────┘
                              ║
    ┌─────────┐    Allow ✓    ║     Allow ✓    ┌─────────┐
    │  User   │──────────────►╢───────────────→│ Server  │
    └─────────┘               ║                └─────────┘
                              ║
    ┌─────────┐    Block ✗    ║                
    │ Malware │────────────×──╢                
    └─────────┘               ║                
```

---

## 🔍 Firewall এর কাজ

```
┌─────────────────────────────────────────────┐
│           Firewall Functions                 │
├─────────────────────────────────────────────┤
│ ✓ Traffic filtering (allow/deny)            │
│ ✓ Network address translation (NAT)         │
│ ✓ VPN gateway                               │
│ ✓ Logging and monitoring                    │
│ ✓ Stateful inspection                       │
│ ✓ Application awareness                     │
└─────────────────────────────────────────────┘
```

---

## 📊 Firewall এর প্রকারভেদ

### ১. Deployment অনুসারে

```
┌─────────────────────────────────────────────────────────┐
│              Firewall Deployment Types                   │
├──────────────────┬────────────────────┬─────────────────┤
│    Hardware      │     Software       │     Cloud       │
├──────────────────┼────────────────────┼─────────────────┤
│ Dedicated device │ Installed on OS    │ Cloud-based     │
│ Cisco, Fortinet  │ Windows Firewall   │ AWS WAF         │
│ Enterprise use   │ Personal use       │ Scalable        │
└──────────────────┴────────────────────┴─────────────────┘
```

### ২. Generation/Technology অনুসারে

```
Evolution of Firewalls:

Gen 1: Packet Filtering
    ↓
Gen 2: Stateful Inspection
    ↓
Gen 3: Application Layer
    ↓
Gen 4: Next-Generation (NGFW)
```

---

## 📦 Packet Filtering Firewall

**সবচেয়ে basic type।** শুধু packet header দেখে।

```
Packet Header Checking:
┌────────────────────────────────────┐
│ Source IP:      192.168.1.100      │ ← Check
│ Dest IP:        10.0.0.50          │ ← Check
│ Source Port:    54321              │ ← Check
│ Dest Port:      80                 │ ← Check
│ Protocol:       TCP                │ ← Check
└────────────────────────────────────┘
         │
         ↓
    Rule Match? 
    Yes → Allow/Deny
    No  → Default Action
```

### সুবিধা ও অসুবিধা

| সুবিধা | অসুবিধা |
|--------|---------|
| Fast | Application বুঝে না |
| Simple | Stateless |
| Low cost | Easy to bypass |

---

## 🔄 Stateful Inspection Firewall

Connection এর state track করে। **বেশি secure।**

```
TCP Connection Tracking:

Client ──SYN──→ Firewall ──→ Server
Client ←SYN-ACK─ Firewall ←── Server
Client ──ACK──→ Firewall ──→ Server

Connection Table:
┌────────────────────────────────────────────────┐
│ Src IP        Dst IP      State      Timeout  │
├────────────────────────────────────────────────┤
│ 192.168.1.10  10.0.0.5    ESTABLISHED  300    │
│ 192.168.1.15  10.0.0.8    SYN_SENT     60     │
└────────────────────────────────────────────────┘

Return traffic automatically allowed!
```

---

## 🌐 Application Layer Firewall (ALF) / Proxy

**Layer 7 এ কাজ করে।** Application content বুঝতে পারে।

```
                    Application Firewall
                           │
  Client ──HTTP Request──→ │ ──→ Inspect Content
                           │     ├── Check URL
                           │     ├── Check payload
                           │     ├── Check SQL injection
                           │     └── Check malware
                           │
                     Clean? │
                   ┌────────┼────────┐
                   ↓        ↓        ↓
                 Allow   Block    Log
```

| Feature | Capability |
|---------|------------|
| Deep inspection | Packet content দেখে |
| Protocol awareness | HTTP, FTP, DNS বুঝে |
| Content filtering | Block specific content |

---

## 🚀 Next-Generation Firewall (NGFW)

**সব features একসাথে!**

```
┌─────────────────────────────────────────────────────────┐
│                 NGFW = All-in-One                        │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │ Packet   │  │ Stateful │  │   App    │  │   IPS    │ │
│  │ Filter   │  │ Inspect  │  │  Control │  │          │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘ │
│                                                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │   SSL    │  │  User    │  │ Threat   │  │ Sandbox  │ │
│  │ Decrypt  │  │ Identity │  │  Intel   │  │          │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘ │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### NGFW Features

| Feature | Description |
|---------|-------------|
| Application Control | Facebook allow, gaming block |
| IPS Integration | Attack detect and block |
| SSL Inspection | Encrypted traffic দেখে |
| User Identity | IP নয়, user অনুযায়ী rule |
| Threat Intelligence | Known bad IPs auto-block |

---

## 📜 Firewall Rules

### Rule Structure

```
Rule = Action + Source + Destination + Service + Log

Example Rules:
┌────┬────────┬───────────────┬───────────────┬──────────┬─────┐
│ #  │ Action │    Source     │  Destination  │ Service  │ Log │
├────┼────────┼───────────────┼───────────────┼──────────┼─────┤
│ 1  │ ALLOW  │ Any           │ Web Server    │ HTTPS    │ No  │
│ 2  │ ALLOW  │ IT_Admins     │ Any           │ SSH      │ Yes │
│ 3  │ DENY   │ Any           │ DB Server     │ Any      │ Yes │
│ 4  │ ALLOW  │ Internal      │ Internet      │ HTTP/S   │ No  │
│ 5  │ DENY   │ Any           │ Any           │ Any      │ Yes │ ← Default
└────┴────────┴───────────────┴───────────────┴──────────┴─────┘

Rules processed TOP to BOTTOM!
First match wins!
```

### Rule Best Practices

```
┌─────────────────────────────────────────────────────────┐
│              Rule Writing Tips                           │
├─────────────────────────────────────────────────────────┤
│ ✓ Most specific rules উপরে                              │
│ ✓ Default deny সবার নিচে                                │
│ ✓ Unused rules remove করুন                             │
│ ✓ Rule এ description লিখুন                              │
│ ✓ Regular audit করুন                                    │
│ ✗ Any-Any-Any allow করবেন না                           │
└─────────────────────────────────────────────────────────┘
```

---

## 🏰 DMZ (Demilitarized Zone)

Public-facing servers এর জন্য **আলাদা zone।**

```
                         INTERNET
                             │
                             ▼
                    ┌────────────────┐
                    │   Firewall 1   │
                    │   (External)   │
                    └────────────────┘
                             │
              ┌──────────────┼──────────────┐
              ▼              ▼              ▼
         ┌────────┐    ┌────────┐    ┌────────┐
         │  Web   │    │  Mail  │    │  DNS   │
         │ Server │    │ Server │    │ Server │
         └────────┘    └────────┘    └────────┘
                       DMZ Zone
              ┌──────────────┼──────────────┐
                             │
                    ┌────────────────┐
                    │   Firewall 2   │
                    │   (Internal)   │
                    └────────────────┘
                             │
              ┌──────────────┼──────────────┐
              ▼              ▼              ▼
         ┌────────┐    ┌────────┐    ┌────────┐
         │   PC   │    │Database│    │  File  │
         │        │    │ Server │    │ Server │
         └────────┘    └────────┘    └────────┘
                    Internal Zone
```

| Zone | Access Level |
|------|--------------|
| Internet | Untrusted |
| DMZ | Semi-trusted |
| Internal | Trusted |

---

## 🔐 Firewall Zones

```
Zone-Based Architecture:

┌─────────────────────────────────────────────────────────┐
│                                                          │
│   UNTRUST          DMZ              TRUST                │
│   Zone            Zone              Zone                 │
│                                                          │
│  ┌──────┐      ┌──────┐         ┌──────┐               │
│  │ Net  │←────→│ FW   │←───────→│ Net  │               │
│  └──────┘      └──────┘         └──────┘               │
│                    ↑                                     │
│                    ↓                                     │
│               ┌──────┐                                   │
│               │ DMZ  │                                   │
│               │ Net  │                                   │
│               └──────┘                                   │
│                                                          │
└─────────────────────────────────────────────────────────┘

Zone Policies:
UNTRUST → TRUST = Very Restricted
TRUST → UNTRUST = Mostly Allowed
ANY → DMZ = Limited Services Only
```

---

## 💻 Windows Firewall Commands

```powershell
# Firewall status দেখুন
netsh advfirewall show allprofiles

# Firewall enable
netsh advfirewall set allprofiles state on

# Rule add করুন (allow ping)
netsh advfirewall firewall add rule name="Allow Ping" ^
    protocol=icmpv4 dir=in action=allow

# Port open করুন
netsh advfirewall firewall add rule name="Open Port 80" ^
    protocol=tcp dir=in localport=80 action=allow

# Rule list দেখুন
netsh advfirewall firewall show rule name=all

# Block an IP
netsh advfirewall firewall add rule name="Block Bad IP" ^
    dir=in action=block remoteip=1.2.3.4
```

---

## 🐧 Linux iptables Examples

```bash
# List rules
iptables -L -n

# Allow SSH (port 22)
iptables -A INPUT -p tcp --dport 22 -j ACCEPT

# Allow established connections
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Block an IP
iptables -A INPUT -s 1.2.3.4 -j DROP

# Default deny
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# Save rules
iptables-save > /etc/iptables.rules
```

---

## 📊 Firewall তুলনা

| Feature | Packet Filter | Stateful | ALF | NGFW |
|---------|--------------|----------|-----|------|
| Header Check | ✓ | ✓ | ✓ | ✓ |
| State Track | ✗ | ✓ | ✓ | ✓ |
| App Aware | ✗ | ✗ | ✓ | ✓ |
| IPS | ✗ | ✗ | ✗ | ✓ |
| SSL Inspect | ✗ | ✗ | △ | ✓ |
| Speed | Fast | Good | Slow | Medium |
| Cost | Low | Medium | High | Highest |

---

## ✏️ অনুশীলনী

### ১. Scenario Based
```
একটি company তে:
- Web server public access দরকার
- Database server শুধু web server access করবে
- Employees internet browse করতে পারবে
- External থেকে internal SSH করা যাবে না

এই scenario র জন্য firewall rules লিখুন।
```

### ২. True/False
```
a) Packet filter firewall application বুঝতে পারে
b) Stateful firewall connection track করে
c) NGFW তে IPS built-in থাকে
d) DMZ fully trusted zone
```

### ৩. নিজে করুন
```
Windows Firewall ব্যবহার করে:
a) Port 8080 open করুন
b) একটি নির্দিষ্ট IP block করুন
c) Firewall rules list দেখুন
```

---

## 🎓 মনে রাখুন

```
Firewall = প্রথম line of defense
কিন্তু only firewall = not enough!

Defense in Depth ব্যবহার করুন!
```

---

**🔙 [পূর্ববর্তী: Network Security](./??-?????????-?????????.md)** | **🔜 [পরবর্তী: VPN](./??-??????.md)**


