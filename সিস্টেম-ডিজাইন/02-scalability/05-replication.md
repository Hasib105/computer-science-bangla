# ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® (Replication)

## üéØ ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ï‡¶ø?

**‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®** ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶á ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ‡•§

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Primary    ‚îÇ
‚îÇ   Database   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Replication
       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚Üì                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Replica 1  ‚îÇ      ‚îÇ   Replica 2  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø:
‚îú‚îÄ‚îÄ High Availability
‚îú‚îÄ‚îÄ Read Scalability
‚îî‚îÄ‚îÄ Disaster Recovery
```

## üìä ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ï‡ßá‡¶® ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞?

### ‡ßß. High Availability
```
Primary ‡¶°‡¶æ‡¶â‡¶® ‡¶π‡¶≤‡ßá:

‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶õ‡¶æ‡¶°‡¶º‡¶æ:
Primary Down ‚Üí ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶°‡¶æ‡¶â‡¶®!

‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶∏‡¶π:
Primary Down ‚Üí Replica Promoted ‚Üí ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶ö‡¶≤‡¶õ‡ßá!
```

### ‡ß®. Read Scalability
```
‡¶∞‡¶ø‡¶°/‡¶∞‡¶æ‡¶á‡¶ü ‡¶∞‡ßá‡¶∂‡¶ø‡¶ì ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ ‡ßØ‡ß¶:‡ßß‡ß¶

‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶õ‡¶æ‡¶°‡¶º‡¶æ:
All reads ‚Üí Primary (Overloaded!)

‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶∏‡¶π:
Writes ‚Üí Primary
Reads ‚Üí Distributed across Replicas
```

### ‡ß©. Disaster Recovery
```
‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡ßß         ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡ß®
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Primary   ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí ‚îÇ  Replica   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

DC1 ‡¶ß‡ßç‡¶¨‡¶Ç‡¶∏ ‡¶π‡¶≤‡ßá‡¶ì DC2-‡¶§‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶õ‡ßá
```

## üîÑ ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶Æ‡ßã‡¶°

### ‡ßß. ‡¶∏‡¶ø‡¶®‡¶ï‡ßç‡¶∞‡ßã‡¶®‡¶æ‡¶∏ ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®
```
Client ‚Üí Primary ‚Üí All Replicas ‚Üí Ack ‚Üí Client

‡¶ü‡¶æ‡¶á‡¶Æ‡¶≤‡¶æ‡¶á‡¶®:
t=0    : Write request ‡¶Ü‡¶∏‡¶≤‡ßã
t=10ms : Primary-‡¶§‡ßá ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
t=20ms : Replica 1-‡¶è ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
t=30ms : Replica 2-‡¶è ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
t=31ms : Client-‡¶ï‡ßá Ack ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã

‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úì Strong Consistency
‚úì ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡¶∏ ‡¶π‡¶¨‡ßá ‡¶®‡¶æ (RPO = 0)

‡¶Ö‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úó High Latency
‚úó ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶∏‡ßç‡¶≤‡ßã ‡¶π‡¶≤‡ßá ‡¶∏‡¶¨ ‡¶∏‡ßç‡¶≤‡ßã
```

### ‡ß®. ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∏‡¶ø‡¶®‡¶ï‡ßç‡¶∞‡ßã‡¶®‡¶æ‡¶∏ ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®
```
Client ‚Üí Primary ‚Üí Ack ‚Üí Client
              ‚Üì
         Replicas (‡¶™‡¶∞‡ßá)

‡¶ü‡¶æ‡¶á‡¶Æ‡¶≤‡¶æ‡¶á‡¶®:
t=0    : Write request ‡¶Ü‡¶∏‡¶≤‡ßã
t=10ms : Primary-‡¶§‡ßá ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
t=11ms : Client-‡¶ï‡ßá Ack ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã
t=50ms : Replica 1-‡¶è ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
t=60ms : Replica 2-‡¶è ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã

‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úì Low Latency
‚úì ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶∏‡ßç‡¶≤‡ßã ‡¶π‡¶≤‡ßá‡¶ì Primary ‡¶™‡ßç‡¶∞‡¶≠‡¶æ‡¶¨‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ

‡¶Ö‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úó Eventual Consistency
‚úó Primary ‡¶ï‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶π‡¶≤‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡¶∏ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
```

### ‡ß©. ‡¶∏‡ßá‡¶Æ‡¶ø-‡¶∏‡¶ø‡¶®‡¶ï‡ßç‡¶∞‡ßã‡¶®‡¶æ‡¶∏ ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®
```
Client ‚Üí Primary ‚Üí At Least 1 Replica ‚Üí Ack ‚Üí Client

‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ‡¶Ø‡¶º ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶≤‡ßá Ack ‡¶¶‡ßá‡¶Ø‡¶º‡•§

‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úì Balanced approach
‚úì ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ü‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ, ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ü‡¶æ ‡¶∏‡ßç‡¶™‡¶ø‡¶°
```

## üèóÔ∏è ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ü‡¶™‡ßã‡¶≤‡¶ú‡¶ø

### ‡ßß. Single Leader (Master-Slave)
```
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    Writes ‚Üí   ‚îÇ    Leader    ‚îÇ
                ‚îÇ   (Master)   ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚Üì             ‚Üì             ‚Üì
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ Follower ‚îÇ  ‚îÇ Follower ‚îÇ  ‚îÇ Follower ‚îÇ
   ‚îÇ (Slave)  ‚îÇ  ‚îÇ (Slave)  ‚îÇ  ‚îÇ (Slave)  ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üë             ‚Üë             ‚Üë
                   Reads

‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úì ‡¶∏‡¶ø‡¶Æ‡ßç‡¶™‡¶≤
‚úì ‡¶ï‡ßã‡¶®‡ßã ‡¶∞‡¶æ‡¶á‡¶ü ‡¶ï‡¶®‡¶´‡ßç‡¶≤‡¶ø‡¶ï‡ßç‡¶ü ‡¶®‡ßá‡¶á

‡¶Ö‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:
‚úó Leader ‡¶¨‡¶ü‡¶≤‡¶®‡ßá‡¶ï
‚úó Leader ‡¶´‡ßá‡¶á‡¶≤‡¶ì‡¶≠‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶≤‡¶æ‡¶ó‡ßá
```

### ‡ß®. Multi-Leader (Master-Master)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Leader 1   ‚îÇ ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí ‚îÇ   Leader 2   ‚îÇ
‚îÇ  (Writes)    ‚îÇ         ‚îÇ   (Writes)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì                        ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇFollowers‚îÇ              ‚îÇFollowers‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞:
- Multi-datacenter deployment
- Offline-capable apps

‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:
- Write Conflicts!
```

### ‡ß©. Leaderless (Peer-to-Peer)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Node 1  ‚îÇ ‚Üê‚îÄ‚Üí ‚îÇ  Node 2  ‚îÇ ‚Üê‚îÄ‚Üí ‚îÇ  Node 3  ‚îÇ
‚îÇ  (R/W)   ‚îÇ     ‚îÇ  (R/W)   ‚îÇ     ‚îÇ  (R/W)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚Üë                                  ‚Üë
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶®‡ßã‡¶°‡ßá Read/Write ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§

Quorum:
W + R > N (‡¶®‡ßã‡¶° ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ)
W = Write Quorum
R = Read Quorum

‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: N=3, W=2, R=2
- ‡ß®‡¶ü‡¶ø ‡¶®‡ßã‡¶°‡ßá ‡¶≤‡¶ø‡¶ñ‡¶§‡ßá ‡¶π‡¶¨‡ßá
- ‡ß®‡¶ü‡¶ø ‡¶®‡ßã‡¶° ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶π‡¶¨‡ßá
- ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá latest data ‡¶™‡¶æ‡¶¨‡ßá
```

## ‚öîÔ∏è Conflict Resolution

### ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡ßá ‡¶ï‡¶®‡¶´‡ßç‡¶≤‡¶ø‡¶ï‡ßç‡¶ü
```
Leader 1: user.name = "‡¶Ü‡¶π‡¶Æ‡ßá‡¶¶"    (t=1)
Leader 2: user.name = "‡¶∞‡¶π‡¶ø‡¶Æ"     (t=1)

‡¶ï‡ßã‡¶®‡¶ü‡¶æ ‡¶∏‡¶†‡¶ø‡¶ï?
```

### ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶ï‡ßå‡¶∂‡¶≤

#### ‡ßß. Last Write Wins (LWW)
```
‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï write ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡¶Ø‡¶º‡•§

Leader 1: name = "‡¶Ü‡¶π‡¶Æ‡ßá‡¶¶"  (t=100)
Leader 2: name = "‡¶∞‡¶π‡¶ø‡¶Æ"   (t=101)
Result:   name = "‡¶∞‡¶π‡¶ø‡¶Æ"   (t=101 ‡¶®‡¶§‡ßÅ‡¶®)

‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: ‡¶°‡¶æ‡¶ü‡¶æ ‡¶π‡¶æ‡¶∞‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
```

#### ‡ß®. Merge
```
‡¶¶‡ßÅ‡¶ü‡ßã ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú ‡¶ï‡¶∞‡¶æ

Leader 1: tags = ["sports"]
Leader 2: tags = ["music"]
Result:   tags = ["sports", "music"]
```

#### ‡ß©. Custom Resolution
```
‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡ßá‡¶≠‡ßá‡¶≤‡ßá ‡¶∏‡¶ø‡¶¶‡ßç‡¶ß‡¶æ‡¶®‡ßç‡¶§ ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ

def resolve_conflict(value1, value2):
    # ‡¶¨‡¶ø‡¶ú‡¶®‡ßá‡¶∏ ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶∏‡¶ø‡¶¶‡ßç‡¶ß‡¶æ‡¶®‡ßç‡¶§
    return pick_winner(value1, value2)
```

## üìä Replication Lag

### Replication Lag ‡¶ï‡¶ø?
```
Primary-‡¶§‡ßá write ‚Üí Replica-‡¶§‡ßá ‡¶™‡ßå‡¶Å‡¶õ‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶≤‡¶æ‡¶ó‡ßá

Primary:   Write at t=0
Replica 1: Receives at t=100ms (lag = 100ms)
Replica 2: Receives at t=150ms (lag = 150ms)
```

### Replication Lag ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ

#### ‡ßß. Read Your Own Writes
```
‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:
t=0   : User writes "Hello"
t=10  : User reads (from replica) - ‡¶¶‡ßá‡¶ñ‡ßá ‡¶®‡¶æ!
t=100 : Replica updated

‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®:
- ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶≤‡ßá‡¶ñ‡¶æ Primary ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶°‡¶º‡¶æ
- ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ Primary ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶°‡¶º‡¶æ
```

#### ‡ß®. Monotonic Reads
```
‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:
Read 1: Replica 1 (‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶°) ‚Üí ‡¶¶‡ßá‡¶ñ‡ßá "Hello"
Read 2: Replica 2 (‡¶™‡ßÅ‡¶∞‡¶æ‡¶§‡¶®) ‚Üí ‡¶¶‡ßá‡¶ñ‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶®‡ßá‡¶á!

‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®:
- ‡¶è‡¶ï‡¶á ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶∞‡¶ø‡¶° ‡¶è‡¶ï‡¶á ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá
- Session stickiness
```

## üîß PostgreSQL ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™

### Streaming Replication
```sql
-- Primary ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá (postgresql.conf):
wal_level = replica
max_wal_senders = 3
wal_keep_size = 64

-- Primary ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá (pg_hba.conf):
host replication replicator replica_ip/32 md5

-- Replica ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá:
pg_basebackup -h primary_host -D /var/lib/postgresql/data -U replicator -P -R
```

### MySQL Replication
```sql
-- Primary ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá:
CREATE USER 'replicator'@'%' IDENTIFIED BY 'password';
GRANT REPLICATION SLAVE ON *.* TO 'replicator'@'%';
SHOW MASTER STATUS;

-- Replica ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá:
CHANGE MASTER TO
    MASTER_HOST='primary_host',
    MASTER_USER='replicator',
    MASTER_PASSWORD='password',
    MASTER_LOG_FILE='mysql-bin.000001',
    MASTER_LOG_POS=154;
START SLAVE;
```

## üìã ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ö‡ßá‡¶ï‡¶≤‡¶ø‡¶∏‡ßç‡¶ü

- [ ] ‡¶∞‡ßá‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶Æ‡ßã‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® (sync/async)
- [ ] ‡¶ü‡¶™‡ßã‡¶≤‡¶ú‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®
- [ ] Failover strategy
- [ ] Replication lag ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç
- [ ] Conflict resolution strategy
- [ ] Read/Write splitting ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
- [ ] ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ strategy

## üìö ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶∏‡ßá‡¶ï‡¶∂‡¶®

[‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶®‡ßç‡¶∏‡¶ø‡¶Ç ‚Üí](../03-load-balancing/README.md)
