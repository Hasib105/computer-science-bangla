# à¦²à§‡à¦¯à¦¼à¦¾à¦° à§ª vs à¦²à§‡à¦¯à¦¼à¦¾à¦° à§­ à¦²à§‹à¦¡ à¦¬à§à¦¯à¦¾à¦²à¦¾à¦¨à§à¦¸à¦¿à¦‚

## ğŸ¯ OSI à¦®à¦¡à§‡à¦² à¦°à¦¿à¦•à§à¦¯à¦¾à¦ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   OSI Model                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Layer 7: Application   â† HTTP, HTTPS, SMTP            â”‚
â”‚  Layer 6: Presentation  â† SSL, Encryption              â”‚
â”‚  Layer 5: Session       â† Sessions                     â”‚
â”‚  Layer 4: Transport     â† TCP, UDP                     â”‚ â† L4 LB
â”‚  Layer 3: Network       â† IP, Routing                  â”‚
â”‚  Layer 2: Data Link     â† MAC, Ethernet                â”‚
â”‚  Layer 1: Physical      â† Cables, Signals              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

L4 = Transport Layer (TCP/UDP)
L7 = Application Layer (HTTP/HTTPS)
```

## ğŸ”Œ Layer 4 Load Balancing

### à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡?
```
TCP/UDP à¦¸à§à¦¤à¦°à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡à¥¤
IP à¦…à§à¦¯à¦¾à¦¡à§à¦°à§‡à¦¸ à¦“ à¦ªà§‹à¦°à§à¦Ÿ à¦¦à§‡à¦–à§‡ à¦¡à¦¿à¦¸à¦¿à¦¶à¦¨ à¦¨à§‡à¦¯à¦¼à¥¤

Packet Header:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Source IP: 192.168.1.100               â”‚
â”‚ Dest IP: 10.0.0.1 (LB)                 â”‚
â”‚ Source Port: 45123                     â”‚
â”‚ Dest Port: 80                          â”‚ â† à¦à¦Ÿà§à¦•à§ à¦¦à§‡à¦–à§‡
â”‚ Protocol: TCP                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

HTTP Content: à¦¦à§‡à¦–à§‡ à¦¨à¦¾!
```

### L4 LB à¦«à§à¦²à§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â†’â”‚   L4 LB        â”‚â”€â”€â”€â†’â”‚ Server 1 â”‚
â”‚          â”‚    â”‚ (IP + Port)    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ TCP Connection â”‚â”€â”€â”€â†’â”‚ Server 2 â”‚
                â”‚   Forwarding   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

L4 LB à¦¶à§à¦§à§ TCP à¦•à¦¾à¦¨à§‡à¦•à¦¶à¦¨ à¦«à¦°à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦•à¦°à§‡à¥¤
HTTP à¦•à¦¨à§à¦Ÿà§‡à¦¨à§à¦Ÿ à¦ªà¦¡à¦¼à§‡ à¦¨à¦¾à¥¤
```

### L4 à¦¸à§à¦¬à¦¿à¦§à¦¾
```
âœ“ à¦…à¦¤à§à¦¯à¦¨à§à¦¤ à¦¦à§à¦°à§à¦¤ (à¦•à¦® à¦ªà§à¦°à¦¸à§‡à¦¸à¦¿à¦‚)
âœ“ à¦¹à¦¾à¦‡ à¦¥à§à¦°à§à¦ªà§à¦Ÿ
âœ“ à¦ªà§à¦°à¦Ÿà§‹à¦•à¦² à¦…à§à¦¯à¦¾à¦—à¦¨à¦¸à§à¦Ÿà¦¿à¦• (TCP, UDP, à¦¯à§‡à¦•à§‹à¦¨à§‹)
âœ“ à¦•à¦® à¦°à¦¿à¦¸à§‹à¦°à§à¦¸ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°
âœ“ SSL/TLS à¦¬à§à¦¯à¦¾à¦•à¦à¦¨à§à¦¡à§‡ à¦¹à§à¦¯à¦¾à¦¨à§à¦¡à§‡à¦² à¦•à¦°à¦¾ à¦¯à¦¾à¦¯à¦¼
```

### L4 à¦…à¦¸à§à¦¬à¦¿à¦§à¦¾
```
âœ— à¦•à¦¨à§à¦Ÿà§‡à¦¨à§à¦Ÿ-à¦¬à§‡à¦¸à¦¡ à¦°à¦¾à¦‰à¦Ÿà¦¿à¦‚ à¦¸à¦®à§à¦­à¦¬ à¦¨à¦¾
âœ— URL, Headers, Cookies à¦¦à§‡à¦–à§‡ à¦¨à¦¾
âœ— SSL Termination à¦•à¦°à§‡ à¦¨à¦¾
âœ— HTTP/2, WebSocket à¦…à¦ªà§à¦Ÿà¦¿à¦®à¦¾à¦‡à¦œà§‡à¦¶à¦¨ à¦¨à§‡à¦‡
âœ— Advanced health checks à¦¨à§‡à¦‡
```

## ğŸŒ Layer 7 Load Balancing

### à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡?
```
HTTP/HTTPS à¦¸à§à¦¤à¦°à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡à¥¤
Request à¦à¦° à¦¸à¦¬ à¦•à¦¿à¦›à§ à¦¦à§‡à¦–à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤

HTTP Request:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/users HTTP/1.1                â”‚
â”‚ Host: example.com                      â”‚ â† Header
â”‚ Cookie: session=abc123                 â”‚ â† Cookie
â”‚ Authorization: Bearer token            â”‚ â† Auth
â”‚ User-Agent: Mozilla/5.0...             â”‚
â”‚                                        â”‚
â”‚ { "name": "John" }                     â”‚ â† Body
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

à¦à¦‡ à¦¸à¦¬ à¦¦à§‡à¦–à§‡ à¦¡à¦¿à¦¸à¦¿à¦¶à¦¨ à¦¨à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡!
```

### L7 LB à¦«à§à¦²à§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â†’â”‚      L7 LB           â”‚
â”‚          â”‚    â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
                â”‚ â”‚ HTTP Request     â”‚â”‚
                â”‚ â”‚ Parse & Analyze  â”‚â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                â”‚                      â”‚
                â”‚ URL = /api/* â†’ API  â”‚
                â”‚ URL = /static/* â†’ CDNâ”‚
                â”‚ Header = mobile â†’ Mobileâ”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                 â†“                 â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ API      â”‚     â”‚ Static   â”‚     â”‚ Mobile   â”‚
   â”‚ Servers  â”‚     â”‚ Servers  â”‚     â”‚ Servers  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### L7 à¦«à¦¿à¦šà¦¾à¦°

#### à§§. URL-Based Routing
```nginx
# Nginx L7 Configuration
location /api/ {
    proxy_pass http://api_servers;
}

location /static/ {
    proxy_pass http://static_servers;
}

location /admin/ {
    proxy_pass http://admin_servers;
}
```

#### à§¨. Header-Based Routing
```nginx
# Mobile vs Desktop
map $http_user_agent $backend {
    ~*mobile mobile_backend;
    default  desktop_backend;
}

location / {
    proxy_pass http://$backend;
}
```

#### à§©. Cookie-Based Routing
```nginx
# A/B Testing
map $cookie_experiment $backend {
    "variant_a" backend_a;
    "variant_b" backend_b;
    default     backend_default;
}
```

### L7 à¦¸à§à¦¬à¦¿à¦§à¦¾
```
âœ“ à¦•à¦¨à§à¦Ÿà§‡à¦¨à§à¦Ÿ-à¦¬à§‡à¦¸à¦¡ à¦°à¦¾à¦‰à¦Ÿà¦¿à¦‚
âœ“ URL, Headers, Cookies à¦¦à§‡à¦–à§‡ à¦¡à¦¿à¦¸à¦¿à¦¶à¦¨
âœ“ SSL Termination
âœ“ Request/Response Modification
âœ“ Caching
âœ“ Compression
âœ“ Rate Limiting
âœ“ WAF (Web Application Firewall)
âœ“ Better Health Checks
```

### L7 à¦…à¦¸à§à¦¬à¦¿à¦§à¦¾
```
âœ— L4 à¦à¦° à¦šà§‡à¦¯à¦¼à§‡ à¦¸à§à¦²à§‹
âœ— à¦¬à§‡à¦¶à¦¿ à¦°à¦¿à¦¸à§‹à¦°à§à¦¸ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°
âœ— à¦¶à§à¦§à§ HTTP/HTTPS (à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤)
âœ— SSL Overhead
```

## ğŸ†š L4 vs L7 à¦¤à§à¦²à¦¨à¦¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       à¦¬à¦¿à¦·à¦¯à¦¼          â”‚      L4         â”‚       L7        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OSI Layer          â”‚ Transport       â”‚ Application     â”‚
â”‚ Protocol           â”‚ TCP, UDP        â”‚ HTTP, HTTPS     â”‚
â”‚ Speed              â”‚ à¦…à¦¤à§à¦¯à¦¨à§à¦¤ à¦¦à§à¦°à§à¦¤   â”‚ à¦¦à§à¦°à§à¦¤           â”‚
â”‚ CPU Usage          â”‚ à¦•à¦®              â”‚ à¦¬à§‡à¦¶à¦¿            â”‚
â”‚ Content Inspection â”‚ à¦¨à¦¾              â”‚ à¦¹à§à¦¯à¦¾à¦           â”‚
â”‚ URL Routing        â”‚ à¦¨à¦¾              â”‚ à¦¹à§à¦¯à¦¾à¦           â”‚
â”‚ SSL Termination    â”‚ à¦¨à¦¾              â”‚ à¦¹à§à¦¯à¦¾à¦           â”‚
â”‚ Caching            â”‚ à¦¨à¦¾              â”‚ à¦¹à§à¦¯à¦¾à¦           â”‚
â”‚ Use Case           â”‚ TCP/UDP Apps    â”‚ Web Apps        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”€ à¦•à¦–à¦¨ à¦•à§‹à¦¨à¦Ÿà¦¿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨?

### L4 à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§à¦¨
```
âœ“ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦•à¦¾à¦¨à§‡à¦•à¦¶à¦¨ (MySQL, PostgreSQL)
âœ“ Mail à¦¸à¦¾à¦°à§à¦­à¦¾à¦° (SMTP)
âœ“ Gaming à¦¸à¦¾à¦°à§à¦­à¦¾à¦° (UDP)
âœ“ VoIP (UDP)
âœ“ à¦–à§à¦¬ à¦¹à¦¾à¦‡ à¦ªà¦¾à¦°à¦«à¦°à¦®à§à¦¯à¦¾à¦¨à§à¦¸ à¦¦à¦°à¦•à¦¾à¦° à¦¹à¦²à§‡
âœ“ Non-HTTP à¦ªà§à¦°à¦Ÿà§‹à¦•à¦²
```

### L7 à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§à¦¨
```
âœ“ à¦“à¦¯à¦¼à§‡à¦¬ à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨
âœ“ REST API
âœ“ à¦®à¦¾à¦‡à¦•à§à¦°à§‹à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸ à¦°à¦¾à¦‰à¦Ÿà¦¿à¦‚
âœ“ A/B Testing
âœ“ Canary Deployments
âœ“ SSL Termination
âœ“ Caching
âœ“ Rate Limiting
```

## ğŸ—ï¸ à¦¹à¦¾à¦‡à¦¬à§à¦°à¦¿à¦¡ à¦†à¦°à§à¦•à¦¿à¦Ÿà§‡à¦•à¦šà¦¾à¦°

```
                    Internet
                        â”‚
                        â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   L4 LB (NLB)    â”‚ â† High throughput
              â”‚   (TCP/UDP)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“             â†“             â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  L7 LB   â”‚  â”‚  L7 LB   â”‚  â”‚  L7 LB   â”‚ â† Content-based
   â”‚  (ALB)   â”‚  â”‚  (ALB)   â”‚  â”‚  (ALB)   â”‚   routing
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚ Servers â”‚   â”‚ Servers â”‚   â”‚ Servers â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

L4 â†’ Fast distribution
L7 â†’ Smart routing
```

## ğŸ“Š AWS à¦‰à¦¦à¦¾à¦¹à¦°à¦£

```
AWS Load Balancers:

Network Load Balancer (NLB) = L4
â”œâ”€â”€ TCP, UDP, TLS
â”œâ”€â”€ Millions of requests/sec
â”œâ”€â”€ Ultra-low latency
â””â”€â”€ Static IP support

Application Load Balancer (ALB) = L7
â”œâ”€â”€ HTTP, HTTPS, WebSocket
â”œâ”€â”€ Path-based routing
â”œâ”€â”€ Host-based routing
â”œâ”€â”€ Lambda integration
â””â”€â”€ WAF integration
```

## ğŸ“š à¦ªà¦°à¦¬à¦°à§à¦¤à§€ à¦Ÿà¦ªà¦¿à¦•

[à¦°à¦¿à¦­à¦¾à¦°à§à¦¸ à¦ªà§à¦°à¦•à§à¦¸à¦¿ â†’](./04-reverse-proxy.md)
