# CAP ржерж┐ржУрж░рзЗржо (CAP Theorem)

## ЁЯОп CAP ржерж┐ржУрж░рзЗржо ржХрж┐?

**CAP ржерж┐ржУрж░рзЗржо** ржмрж▓рзЗ ржпрзЗ ржПржХржЯрж┐ ржбрж┐рж╕рзНржЯрзНрж░рж┐ржмрж┐ржЙржЯрзЗржб рж╕рж┐рж╕рзНржЯрзЗржо ржПржХржЗ рж╕рж╛ржерзЗ рждрж┐ржиржЯрж┐ ржЧрзНржпрж╛рж░рж╛ржирзНржЯрж┐рж░ ржоржзрзНржпрзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ ржжрзБржЗржЯрж┐ ржжрж┐рждрзЗ ржкрж╛рж░рзЗ:

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ                   CAP ржерж┐ржУрж░рзЗржо                        тФВ
тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
тФВ                                                     тФВ
тФВ                    C                                тФВ
тФВ                 (Consistency)                       тФВ
тФВ                    /\                               тФВ
тФВ                   /  \                              тФВ
тФВ                  /    \                             тФВ
тФВ                 /      \                            тФВ
тФВ                /   CA   \                           тФВ
тФВ               /          \                          тФВ
тФВ              /тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФА\                         тФВ
тФВ             /              \                        тФВ
тФВ            / CP          AP \                       тФВ
тФВ           /                  \                      тФВ
тФВ          A тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФА P                   тФВ
тФВ    (Availability)      (Partition Tolerance)       тФВ
тФВ                                                     тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ

ржЖржкржирж┐ ржкрзЗрждрзЗ ржкрж╛рж░рзЗржи:
- CA (Consistency + Availability)
- CP (Consistency + Partition Tolerance)
- AP (Availability + Partition Tolerance)

ржХрж┐ржирзНрждрзБ CAP ржПржХрж╕рж╛ржерзЗ ржиржпрж╝!
```

## ЁЯУЦ рждрж┐ржиржЯрж┐ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд

### C - Consistency (рж╕рж╛ржоржЮрзНржЬрж╕рзНржпрждрж╛)
```
рж╕ржВржЬрзНржЮрж╛: рж╕ржм ржирзЛржб ржПржХржЗ рж╕ржоржпрж╝рзЗ ржПржХржЗ ржбрж╛ржЯрж╛ ржжрзЗржЦрзЗред

тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР     тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР     тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ  Node 1  тФВ     тФВ  Node 2  тФВ     тФВ  Node 3  тФВ
тФВ data = 5 тФВ     тФВ data = 5 тФВ     тФВ data = 5 тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
      тЖС               тЖС               тЖС
      тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ┤тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
               рж╕ржм ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ рзл

ржпрзЗржХрзЛржирзЛ ржирзЛржбрзЗ рж░рж┐ржб ржХрж░рж▓рзЗ ржПржХржЗ ржнрзНржпрж╛рж▓рзБ ржкрж╛ржмрзЗред
```

### A - Availability (ржкрзНрж░рж╛ржкрзНржпрждрж╛)
```
рж╕ржВржЬрзНржЮрж╛: ржкрзНрж░рждрж┐ржЯрж┐ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржПржХржЯрж┐ рж░рзЗрж╕ржкржирзНрж╕ ржкрж╛ржпрж╝ (рж╕ржлрж▓ ржмрж╛ ржмрзНржпрж░рзНрже)ред

тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ  Client  тФВ
тФФтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФШ
     тФВ Request
     тЖУ
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ  Server  тФВ тЖР рж╕ржмрж╕ржоржпрж╝ рж░рзЗрж╕ржкржирзНрж╕ ржжрзЗржпрж╝
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     (ржПржоржиржХрж┐ ржХрж┐ржЫрзБ ржирзЛржб ржбрж╛ржЙржи ржерж╛ржХрж▓рзЗржУ)

ржХрзЛржирзЛ ржЯрж╛ржЗржоржЖржЙржЯ ржирзЗржЗ, рж╕ржмрж╕ржоржпрж╝ ржЙрждрзНрждрж░ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ред
```

### P - Partition Tolerance (ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╕рж╣ржирж╢рзАрж▓рждрж╛)
```
рж╕ржВржЬрзНржЮрж╛: ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╣рж▓рзЗржУ рж╕рж┐рж╕рзНржЯрзЗржо ржХрж╛ржЬ ржХрж░рждрзЗ ржерж╛ржХрзЗред

рж╕рзНржмрж╛ржнрж╛ржмрж┐ржХ ржЕржмрж╕рзНржерж╛:
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР тЖРтЖТ тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР тЖРтЖТ тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ  Node 1  тФВ     тФВ  Node 2  тФВ     тФВ  Node 3  тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ

ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╣рж▓рзЗ:
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР     тХС     тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР тЖРтЖТ тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ  Node 1  тФВ  тЬЧ  тХС     тФВ  Node 2  тФВ     тФВ  Node 3  тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     тХС     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                 тХС
          ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржмрж┐ржЪрзНржЫрж┐ржирзНржи

рж╕рж┐рж╕рзНржЯрзЗржо рждрж╛рж░ржкрж░ржУ ржЪрж▓рждрзЗ ржерж╛ржХрзЗред
```

## ЁЯФД ржХрзЗржи рждрж┐ржиржЯрж┐ ржПржХрж╕рж╛ржерзЗ рж╕ржорзНржнржм ржиржпрж╝?

### ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╣рж▓рзЗ ржХрж┐ рж╣ржпрж╝?
```
Node A           тЬЧ Network тЬЧ           Node B
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР         Failure          тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ data = 1 тФВ тЖРтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтЖТ   тФВ data = 1 тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ                          тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ

Client: Node A-рждрзЗ data = 2 рж▓рж┐ржЦрждрзЗ ржЪрж╛ржпрж╝

ржЕржкрж╢ржи рзз (Consistency ржмрзЗржЫрзЗ ржирзЗржУржпрж╝рж╛):
- Node B-рждрзЗ ржЖржкржбрзЗржЯ ржирж╛ рж╣ржУржпрж╝рж╛ ржкрж░рзНржпржирзНржд ржЕржкрзЗржХрзНрж╖рж╛
- ржХрж┐ржирзНрждрзБ ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржмрж┐ржЪрзНржЫрж┐ржирзНржи!
- рждрж╛ржЗ Availability рж╣рж╛рж░рж╛рждрзЗ рж╣ржмрзЗ

ржЕржкрж╢ржи рзи (Availability ржмрзЗржЫрзЗ ржирзЗржУржпрж╝рж╛):
- Node A-рждрзЗ data = 2 рж▓рж┐ржЦрзЗ ржжрж╛ржУ
- Node B рждрзЗ data = 1 ржерж╛ржХржмрзЗ
- рждрж╛ржЗ Consistency рж╣рж╛рж░рж╛рждрзЗ рж╣ржмрзЗ

ржЙржкрж╕ржВрж╣рж╛рж░: ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╣рж▓рзЗ C ржмрж╛ A ржПржХржЯрж┐ ржЫрж╛ржбрж╝рждрзЗ рж╣ржмрзЗ
```

## ЁЯУК CAP ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐ ржЕржирзБржпрж╛ржпрж╝рзА ржбрж╛ржЯрж╛ржмрзЗрж╕

### CP (Consistency + Partition Tolerance)
```
ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:
- рж╕рзНржЯрзНрж░ржВ ржХржирж╕рж┐рж╕рзНржЯрзЗржирзНрж╕рж┐
- ржкрж╛рж░рзНржЯрж┐рж╢ржирзЗ ржХрж┐ржЫрзБ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржлрзЗржЗрж▓ рж╣рждрзЗ ржкрж╛рж░рзЗ

ржбрж╛ржЯрж╛ржмрзЗрж╕:
тФЬтФАтФА MongoDB (default)
тФЬтФАтФА HBase
тФЬтФАтФА Redis (Cluster)
тФЬтФАтФА Zookeeper
тФФтФАтФА Consul

ржмрзНржпржмрж╣рж╛рж░:
- ржмрзНржпрж╛ржВржХрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо
- ржЗржиржнрзЗржирзНржЯрж░рж┐ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ
- ржпрзЗржЦрж╛ржирзЗ ржнрзБрж▓ ржбрж╛ржЯрж╛ ржЧрзНрж░рж╣ржгржпрзЛржЧрзНржп ржиржпрж╝
```

### AP (Availability + Partition Tolerance)
```
ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:
- рж╕ржмрж╕ржоржпрж╝ рж░рзЗрж╕ржкржирзНрж╕ ржжрзЗржпрж╝
- ржбрж╛ржЯрж╛ рж╕рж╛ржоржпрж╝рж┐ржХржнрж╛ржмрзЗ ржЗржиржХржирж╕рж┐рж╕рзНржЯрзЗржирзНржЯ рж╣рждрзЗ ржкрж╛рж░рзЗ

ржбрж╛ржЯрж╛ржмрзЗрж╕:
тФЬтФАтФА Cassandra
тФЬтФАтФА CouchDB
тФЬтФАтФА DynamoDB
тФЬтФАтФА Riak
тФФтФАтФА Voldemort

ржмрзНржпржмрж╣рж╛рж░:
- рж╕рзЛрж╢рзНржпрж╛рж▓ ржорж┐ржбрж┐ржпрж╝рж╛ ржлрж┐ржб
- рж╢ржкрж┐ржВ ржХрж╛рж░рзНржЯ
- DNS рж╕рж┐рж╕рзНржЯрзЗржо
```

### CA (Consistency + Availability)
```
ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:
- рж╕рж┐ржЩрзНржЧрзЗрж▓ ржирзЛржб рж╕рж┐рж╕рзНржЯрзЗржо (ржкрзНрж░рзНржпрж╛ржХрзНржЯрж┐ржХрзНржпрж╛рж▓рж┐)
- ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░рзЗ ржирж╛

ржбрж╛ржЯрж╛ржмрзЗрж╕:
тФЬтФАтФА Traditional RDBMS (single node)
тФЬтФАтФА PostgreSQL (single node)
тФФтФАтФА MySQL (single node)

ржирзЛржЯ: ржмрж╛рж╕рзНрждржмрзЗ ржбрж┐рж╕рзНржЯрзНрж░рж┐ржмрж┐ржЙржЯрзЗржб рж╕рж┐рж╕рзНржЯрзЗржорзЗ CA рж╕ржорзНржнржм ржиржпрж╝
ржХрж╛рж░ржг ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржлрзЗржЗрж▓рж╛рж░ ржЕржирж┐ржмрж╛рж░рзНржпред
```

## ЁЯОЪя╕П PACELC ржерж┐ржУрж░рзЗржо

CAP-ржПрж░ ржПржХрзНрж╕ржЯрзЗржирж╢ржи:

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ                      PACELC                                 тФВ
тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
тФВ                                                             тФВ
тФВ  ржпржЦржи Partition (P):                                        тФВ
тФВ  тФЬтФАтФА Availability (A) ржмрж╛                                    тФВ
тФВ  тФФтФАтФА Consistency (C) ржмрзЗржЫрзЗ ржирж╛ржУ                               тФВ
тФВ                                                             тФВ
тФВ  Else (E) - ржкрж╛рж░рзНржЯрж┐рж╢ржи ржирзЗржЗ:                                   тФВ
тФВ  тФЬтФАтФА Latency (L) ржмрж╛                                         тФВ
тФВ  тФФтФАтФА Consistency (C) ржмрзЗржЫрзЗ ржирж╛ржУ                               тФВ
тФВ                                                             тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ

ржЙржжрж╛рж╣рж░ржг:
- Cassandra: PA/EL (Availability ржУ Latency ржкрзНрж░рж╛ржзрж╛ржирзНржп)
- MongoDB: PC/EC (Consistency ржкрзНрж░рж╛ржзрж╛ржирзНржп)
- DynamoDB: PA/EL (ржХржиржлрж┐ржЧрж╛рж░ржпрзЛржЧрзНржп)
```

## ЁЯТб ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг

### ржЙржжрж╛рж╣рж░ржг рзз: ржмрзНржпрж╛ржВржХ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░
```
рж╕рж┐ржирж╛рж░рж┐ржУ: A ржерзЗржХрзЗ B-рждрзЗ рззрзжрзжрзж ржЯрж╛ржХрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░

CP ржмрзЗржЫрзЗ ржирзЗржУржпрж╝рж╛ (рж╕ржарж┐ржХ ржкржЫржирзНржж):
- ржкрж╛рж░рзНржЯрж┐рж╢ржи рж╣рж▓рзЗ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ рж╣ржмрзЗ ржирж╛
- ржХрж┐ржирзНрждрзБ ржнрзБрж▓ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржжрзЗржЦрж╛ржмрзЗ ржирж╛
- рж╕рж╛ржоржпрж╝рж┐ржХ ржЕрж╕рзБржмрж┐ржзрж╛ > ржнрзБрж▓ ржбрж╛ржЯрж╛

AP ржмрзЗржЫрзЗ ржирж┐рж▓рзЗ (ржнрзБрж▓ ржкржЫржирзНржж):
- A ржерзЗржХрзЗ ржЯрж╛ржХрж╛ ржХрж╛ржЯрж╛ рж╣рж▓рзЛ
- ржХрж┐ржирзНрждрзБ B-рждрзЗ ржпрзЛржЧ рж╣ржпрж╝ржирж┐ (ржкрж╛рж░рзНржЯрж┐рж╢ржи)
- ржЯрж╛ржХрж╛ рж╣рж╛рж░рж┐ржпрж╝рзЗ ржЧрзЗрж▓!
```

### ржЙржжрж╛рж╣рж░ржг рзи: рж╕рзЛрж╢рзНржпрж╛рж▓ ржорж┐ржбрж┐ржпрж╝рж╛ рж▓рж╛ржЗржХ
```
рж╕рж┐ржирж╛рж░рж┐ржУ: ржПржХржЯрж┐ ржкрзЛрж╕рзНржЯрзЗ рж▓рж╛ржЗржХ рж╕ржВржЦрзНржпрж╛

AP ржмрзЗржЫрзЗ ржирзЗржУржпрж╝рж╛ (рж╕ржарж┐ржХ ржкржЫржирзНржж):
- User A ржжрзЗржЦржЫрзЗ: рзпрзп рж▓рж╛ржЗржХ
- User B ржжрзЗржЦржЫрзЗ: рззрзжрзж рж▓рж╛ржЗржХ
- ржХрж┐ржЫрзБ рж╕рзЗржХрзЗржирзНржб ржкрж░ ржарж┐ржХ рж╣ржпрж╝рзЗ ржпрж╛ржмрзЗ
- ржПрждрзЗ ржХрзЛржирзЛ рж╕ржорж╕рзНржпрж╛ ржирзЗржЗ

CP ржмрзЗржЫрзЗ ржирж┐рж▓рзЗ (ржЕржирзБржкржпрзБржХрзНржд):
- рж▓рж╛ржЗржХ ржмрж╛ржЯржи ржХрж╛ржЬ ржХрж░ржЫрзЗ ржирж╛
- ржЗржЙржЬрж╛рж░ ржПржХрзНрж╕ржкрзЗрж░рж┐ржпрж╝рзЗржирзНрж╕ ржЦрж╛рж░рж╛ржк
```

## ЁЯФз ржХржирж╕рж┐рж╕рзНржЯрзЗржирзНрж╕рж┐ ржоржбрзЗрж▓

### рзз. Strong Consistency
```
Write тЖТ рж╕ржм рж░рзЗржкрзНрж▓рж┐ржХрж╛ржпрж╝ тЖТ Ack тЖТ Read

ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:
- рж░рж┐ржб рж╕ржмрж╕ржоржпрж╝ рж╕рж░рзНржмрж╢рзЗрж╖ рж░рж╛ржЗржЯ ржжрзЗржЦрзЗ
- рж╕ржмржЪрзЗржпрж╝рзЗ рж╕рзНрж▓рзЛ
- ржмрзНржпрж╛ржВржХрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржорзЗ ржмрзНржпржмрж╣рж╛рж░
```

### рзи. Eventual Consistency
```
Write тЖТ Ack тЖТ Read (ржкрзБрж░рж╛рждржи рж╣рждрзЗ ржкрж╛рж░рзЗ)
            тЖУ
      Background Sync
            тЖУ
      Eventually рж╕ржм ржирзЛржб ржЖржкржбрзЗржЯ

ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:
- ржжрзНрж░рзБржд рж░рзЗрж╕ржкржирзНрж╕
- рж╕рж╛ржоржпрж╝рж┐ржХ ржЗржиржХржирж╕рж┐рж╕рзНржЯрзЗржирзНрж╕рж┐
- DNS, рж╕рзЛрж╢рзНржпрж╛рж▓ ржорж┐ржбрж┐ржпрж╝рж╛ржпрж╝ ржмрзНржпржмрж╣рж╛рж░
```

### рзй. Causal Consistency
```
A рж▓рж┐ржЦрж▓рзЛ: x = 1
B ржкржбрж╝рж▓рзЛ x = 1, рждрж╛рж░ржкрж░ рж▓рж┐ржЦрж▓рзЛ y = 2
C ржХрзЗ y = 2 ржжрзЗржЦрждрзЗ рж╣рж▓рзЗ x = 1 ржУ ржжрзЗржЦрждрзЗ рж╣ржмрзЗ

ржХрж╛рж░рзНржпржХрж╛рж░ржг рж╕ржорзНржкрж░рзНржХ ржорзЗржирзЗ ржЪрж▓рзЗред
```

### рзк. Read-Your-Writes Consistency
```
ржЖржкржирж┐ ржпрж╛ рж▓рж┐ржЦрж▓рзЗржи, ржЖржкржирж┐ рждрж╛ржЗ ржкржбрж╝ржмрзЗржиред

Write: name = "рж░рж╣рж┐ржо"
Read: name = "рж░рж╣рж┐ржо" тЬУ

ржЕржирзНржпрж░рж╛ ржкрзБрж░рж╛рждржи ржбрж╛ржЯрж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗред
```

## ЁЯУР ржЯрзНрж░рзЗржб-ржЕржл ржЯрзЗржмрж┐рж▓

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ рж╕рж┐рж╕рзНржЯрзЗржо            тФВ C        тФВ A        тФВ ржмрж┐ржмрзЗржЪржирж╛      тФВ
тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ╝тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ╝тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ╝тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФд
тФВ ржмрзНржпрж╛ржВржХ             тФВ тЬУ рж╣рж╛ржЗ   тФВ тЖУ рж▓рзЛ    тФВ ржнрзБрж▓ ржбрж╛ржЯрж╛ ржорж╛рж░рж╛рждрзНржоржХтФВ
тФВ рж╕рзЛрж╢рзНржпрж╛рж▓ ржорж┐ржбрж┐ржпрж╝рж╛   тФВ тЖУ рж▓рзЛ    тФВ тЬУ рж╣рж╛ржЗ   тФВ UX ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг тФВ
тФВ ржЗржиржнрзЗржирзНржЯрж░рж┐         тФВ тЬУ рж╣рж╛ржЗ   тФВ ржорж┐ржбрж┐ржпрж╝рж╛ржотФВ ржУржнрж╛рж░рж╕рзЗрж▓ рж░рзЛржз  тФВ
тФВ рж╕рж╛рж░рзНржЪ ржЗржЮрзНржЬрж┐ржи      тФВ ржорж┐ржбрж┐ржпрж╝рж╛ржотФВ тЬУ рж╣рж╛ржЗ   тФВ ржлрзНрж░рзЗрж╢ ржирж╛ рж╣рж▓рзЗржУ ржЪрж▓рзЗтФВ
тФВ ржорзЗрж╕рзЗржЬрж┐ржВ          тФВ тЬУ рж╣рж╛ржЗ   тФВ тЬУ рж╣рж╛ржЗ   тФВ ржорзЗрж╕рзЗржЬ рж╣рж╛рж░рж╛ржирзЛ ржпрж╛ржмрзЗ ржирж╛тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ┤тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ┤тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ┤тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
```

## ЁЯОп рж╕рж┐ржжрзНржзрж╛ржирзНржд ржЧрж╛ржЗржб

```
ржкрзНрж░рж╢рзНржи рзз: ржнрзБрж▓ ржбрж╛ржЯрж╛ ржХрж┐ ржЧрзНрж░рж╣ржгржпрзЛржЧрзНржп?
тФЬтФАтФА ржирж╛ тЖТ CP ржмрзЗржЫрзЗ ржирж┐ржи
тФФтФАтФА рж╣рзНржпрж╛ржБ (рж╕рж╛ржоржпрж╝рж┐ржХржнрж╛ржмрзЗ) тЖТ ржкрзНрж░рж╢рзНржи рзи

ржкрзНрж░рж╢рзНржи рзи: Downtime ржХрж┐ ржЧрзНрж░рж╣ржгржпрзЛржЧрзНржп?
тФЬтФАтФА ржирж╛ тЖТ AP ржмрзЗржЫрзЗ ржирж┐ржи
тФФтФАтФА рж╣рзНржпрж╛ржБ (рж╕рж╛ржоржпрж╝рж┐ржХржнрж╛ржмрзЗ) тЖТ CP ржмрзЗржЫрзЗ ржирж┐ржи

ржкрзНрж░рж╢рзНржи рзй: ржХрзЛржи ржбрж╛ржЯрж╛рж░ ржЬржирзНржп?
тФЬтФАтФА ржлрж┐ржирж╛ржирзНрж╕рж┐ржпрж╝рж╛рж▓ ржбрж╛ржЯрж╛ тЖТ CP
тФЬтФАтФА ржЗржЙржЬрж╛рж░ ржкрзНрж░рзЛржлрж╛ржЗрж▓ тЖТ AP
тФЬтФАтФА ржЕрж░рзНржбрж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржо тЖТ CP
тФФтФАтФА ржЕрзНржпрж╛ржирж╛рж▓рж┐ржЯрж┐ржХрзНрж╕ тЖТ AP
```

## тЬЕ рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк

```
рзз. CAP ржерж┐ржУрж░рзЗржо ржПржХржЯрж┐ ржЯрзНрж░рзЗржб-ржЕржл
   - рждрж┐ржиржЯрж┐ ржПржХрж╕рж╛ржерзЗ ржкрж╛ржУржпрж╝рж╛ рж╕ржорзНржнржм ржиржпрж╝

рзи. ржмрж╛рж╕рзНрждржмрзЗ P ржЫрж╛ржбрж╝рж╛ ржЪрж▓рзЗ ржирж╛
   - рждрж╛ржЗ ржкржЫржирзНржж рж╣рж▓рзЛ C ржмрж╛ A

рзй. рж╕рж┐рж╕рзНржЯрзЗржо ржЕржирзБржпрж╛ржпрж╝рзА рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирж┐ржи
   - ржлрж┐ржирж╛ржирзНрж╕рж┐ржпрж╝рж╛рж▓ тЖТ CP
   - рж╕рзЛрж╢рзНржпрж╛рж▓ тЖТ AP

рзк. Eventual Consistency ржпржерзЗрж╖рзНржЯ рж╣рждрзЗ ржкрж╛рж░рзЗ
   - рж╕ржм ржХрзНрж╖рзЗрждрзНрж░рзЗ Strong Consistency рж▓рж╛ржЧрзЗ ржирж╛
```

## ЁЯУЪ ржкрж░ржмрж░рзНрждрзА ржЯржкрж┐ржХ

[рж╕рзНржХрзЗрж▓рзЗржмрж┐рж▓рж┐ржЯрж┐ тЖТ](../02-scalability/README.md)
