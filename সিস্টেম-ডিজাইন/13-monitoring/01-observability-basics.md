# Observability à¦ªà¦°à¦¿à¦šà¦¿à¦¤à¦¿

## ğŸ¯ Observability à¦•à¦¿?

**Observability** à¦¹à¦²à§‹ system-à¦à¦° internal state à¦¬à¦¾à¦¹à§à¦¯à¦¿à¦• outputs à¦¦à§‡à¦–à§‡ à¦¬à§‹à¦à¦¾à¦° à¦•à§à¦·à¦®à¦¤à¦¾à¥¤

```
Monitoring: "Is the system working?"
Observability: "Why is the system not working?"

Monitoring â†’ Known unknowns (predefined alerts)
Observability â†’ Unknown unknowns (explore & discover)
```

## ğŸ“Š Three Pillars of Observability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Three Pillars                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚         â”‚
â”‚   â”‚    Logs     â”‚   â”‚   Metrics   â”‚   â”‚   Traces    â”‚         â”‚
â”‚   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚          â”‚                 â”‚                 â”‚                 â”‚
â”‚   "What          "How              "Where                      â”‚
â”‚    happened?"     much/many?"       did it go?"                â”‚
â”‚                                                                 â”‚
â”‚   Text records   Numeric values    Request path                â”‚
â”‚   with context   over time         across services             â”‚
â”‚                                                                 â”‚
â”‚   Debug errors   Dashboards        Find bottlenecks            â”‚
â”‚   Audit trail    Trends            Debug latency               â”‚
â”‚                  Alerts                                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Logs

```
What: Discrete events with context

[2024-01-26 10:30:45] ERROR OrderService - 
Failed to process order #12345: 
Payment declined for user user_789
{
  "order_id": "12345",
  "user_id": "user_789",
  "error_code": "PAYMENT_DECLINED",
  "amount": 1500.00
}

Use for:
- Debugging specific issues
- Audit trails
- Security analysis
```

## ğŸ“ˆ Metrics

```
What: Numeric measurements over time

http_requests_total{method="GET", status="200"} 15234
http_request_duration_seconds{quantile="0.99"} 0.250
order_processing_time_seconds 2.5
active_users_count 5432

Types:
- Counter: Only increases (requests, errors)
- Gauge: Can go up/down (CPU, memory, active users)
- Histogram: Distribution (latency buckets)
- Summary: Percentiles (p50, p95, p99)
```

## ğŸ”— Traces

```
What: Request journey across services

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Distributed Trace                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Trace ID: abc-123-xyz                                     â”‚
â”‚                                                            â”‚
â”‚  â”œâ”€â”€ API Gateway (50ms)                                    â”‚
â”‚  â”‚   â””â”€â”€ Auth Service (15ms)                              â”‚
â”‚  â”‚                                                         â”‚
â”‚  â”œâ”€â”€ Order Service (200ms)                                â”‚
â”‚  â”‚   â”œâ”€â”€ Inventory Service (80ms)                         â”‚
â”‚  â”‚   â””â”€â”€ Pricing Service (40ms)                           â”‚
â”‚  â”‚                                                         â”‚
â”‚  â””â”€â”€ Payment Service (150ms) â† Slow!                      â”‚
â”‚      â””â”€â”€ External Payment API (130ms)                     â”‚
â”‚                                                            â”‚
â”‚  Total: 400ms                                              â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ Observability Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Observability Stack                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚     â”‚Service Aâ”‚ â”‚Service Bâ”‚ â”‚Service Câ”‚ â”‚Service Dâ”‚           â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â”‚
â”‚          â”‚           â”‚           â”‚           â”‚                 â”‚
â”‚          â”‚ Logs, Metrics, Traces â”‚           â”‚                 â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                      â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚         â”‚            â”‚            â”‚                           â”‚
â”‚         â†“            â†“            â†“                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚   ELK    â”‚ â”‚Prometheusâ”‚ â”‚  Jaeger  â”‚                     â”‚
â”‚   â”‚ (Logs)   â”‚ â”‚(Metrics) â”‚ â”‚(Traces)  â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚        â”‚            â”‚            â”‚                            â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                     â†“                                         â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚            â”‚    Grafana     â”‚                                 â”‚
â”‚            â”‚  (Dashboards)  â”‚                                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                     â”‚                                         â”‚
â”‚                     â†“                                         â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚            â”‚   Alerting     â”‚                                 â”‚
â”‚            â”‚ (PagerDuty)    â”‚                                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¡ Best Practices

```
âœ“ Correlate all three pillars
  - Same trace ID in logs, metrics labels, traces
  
âœ“ Define SLIs/SLOs
  - Service Level Indicators
  - Service Level Objectives
  
âœ“ Alert on symptoms, not causes
  - "High error rate" not "CPU high"
  
âœ“ Structured logging
  - JSON format for parseability
  
âœ“ Sampling for high-volume traces
  - 1% of traffic for most cases
```

## ğŸ“š à¦ªà¦°à¦¬à¦°à§à¦¤à§€ à¦Ÿà¦ªà¦¿à¦•

[Logging â†’](./02-logging.md)
