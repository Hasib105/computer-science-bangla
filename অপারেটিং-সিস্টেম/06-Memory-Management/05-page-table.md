# Page Table Structures (à¦ªà§‡à¦œ à¦Ÿà§‡à¦¬à¦¿à¦² à¦¸à§à¦Ÿà§à¦°à¦¾à¦•à¦šà¦¾à¦°)

## ğŸ“Œ Page Table à¦à¦° à¦¸à¦®à¦¸à§à¦¯à¦¾

à¦¬à¦¡à¦¼ address space à¦ page table à¦…à¦¨à§‡à¦• à¦¬à¦¡à¦¼ à¦¹à¦¯à¦¼à§‡ à¦¯à¦¾à¦¯à¦¼à¥¤

```
Example:
â€¢ 32-bit address space
â€¢ Page size: 4 KB (2^12)
â€¢ Page table entries: 2^32 / 2^12 = 2^20 = 1 million entries!
â€¢ Each entry: 4 bytes
â€¢ Page table size: 4 MB per process!

64-bit system à¦¹à¦²à§‡:
â€¢ 2^64 / 2^12 = 2^52 entries!
â€¢ Impossible to store!
```

---

## ğŸ—ï¸ Page Table Structures

### à§§. Hierarchical Page Tables

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Two-Level Page Table                       â”‚
â”‚                                                             â”‚
â”‚   32-bit Logical Address:                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚    p1      â”‚     p2     â”‚    Offset    â”‚               â”‚
â”‚   â”‚  (10 bits) â”‚ (10 bits)  â”‚  (12 bits)   â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚             â”‚             â”‚                       â”‚
â”‚         â–¼             â”‚             â”‚                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚             â”‚                       â”‚
â”‚   â”‚ Outer    â”‚        â”‚             â”‚                       â”‚
â”‚   â”‚ Page     â”‚        â”‚             â”‚                       â”‚
â”‚   â”‚ Table    â”‚        â”‚             â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚             â”‚                       â”‚
â”‚        â”‚              â–¼             â”‚                       â”‚
â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                       â”‚
â”‚        â””â”€â”€â”€â”€â”€â–ºâ”‚  Inner   â”‚         â”‚                       â”‚
â”‚               â”‚  Page    â”‚         â”‚                       â”‚
â”‚               â”‚  Table   â”‚         â”‚                       â”‚
â”‚               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚                       â”‚
â”‚                    â”‚               â”‚                       â”‚
â”‚                    â”‚    Frame      â”‚                       â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                           â–¼                                 â”‚
â”‚                    Physical Address                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### à¦¸à§à¦¬à¦¿à¦§à¦¾

```
â€¢ à¦ªà§à¦°à§‹ page table memory à¦¤à§‡ à¦°à¦¾à¦–à¦¤à§‡ à¦¹à¦¯à¦¼ à¦¨à¦¾
â€¢ Unused address space à¦à¦° à¦œà¦¨à§à¦¯ inner tables allocate à¦¹à¦¯à¦¼ à¦¨à¦¾

Example:
Process uses only 2 MB of 4 GB space
Full table: 4 MB
Two-level: Only needed tables (~few KB)
```

### Three-Level Page Table (64-bit)

```
64-bit Address:
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ p1  â”‚ p2  â”‚ p3  â”‚ p4  â”‚    Offset    â”‚
â””â”€â”€â”¬â”€â”€â”´â”€â”€â”¬â”€â”€â”´â”€â”€â”¬â”€â”€â”´â”€â”€â”¬â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
   â”‚     â”‚     â”‚     â”‚          â”‚
   â–¼     â–¼     â–¼     â–¼          â”‚
  L1 â†’ L2 â†’ L3 â†’ L4 â†’ Frame + Offset

4-level used in x86-64 (Intel/AMD)
```

---

### à§¨. Hashed Page Tables

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Hashed Page Table                          â”‚
â”‚                                                             â”‚
â”‚   Page Number â”€â”€â–º Hash Function                             â”‚
â”‚                        â”‚                                    â”‚
â”‚                        â–¼                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚              Hash Table                  â”‚              â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚   â”‚  0   â”‚  1   â”‚  2    â”‚    ...           â”‚              â”‚
â”‚   â””â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚      â”‚                                                      â”‚
â”‚      â–¼                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚ Pageâ”‚Frameâ”‚Next â”‚    Linked      â”‚                     â”‚
â”‚   â”‚  5  â”‚ 12  â”‚  â—â”€â”€â”¼â”€â”€â”€â–º List       â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜    (collision) â”‚                     â”‚
â”‚                                                             â”‚
â”‚   Hash(page_number) = index                                 â”‚
â”‚   Handle collisions with chaining                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Clustered Page Tables

```
à¦¬à¦¡à¦¼ address space à¦à¦° à¦œà¦¨à§à¦¯:
à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ hash table entry à¦à¦•à¦¾à¦§à¦¿à¦• page mappings à¦°à¦¾à¦–à§‡

Entry: [page1â†’frame1, page2â†’frame2, page3â†’frame3, ...]

à¦¸à§à¦¬à¦¿à¦§à¦¾: à¦•à¦® entries, à¦¬à¦¡à¦¼ sparse address space à¦ à¦­à¦¾à¦²à§‹
```

---

### à§©. Inverted Page Table

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Inverted Page Table                        â”‚
â”‚                                                             â”‚
â”‚   Traditional:                 Inverted:                    â”‚
â”‚   One entry per page          One entry per FRAME          â”‚
â”‚   (2^20 entries for 32-bit)   (Only physical frames)       â”‚
â”‚                                                             â”‚
â”‚   Physical Memory has N frames                              â”‚
â”‚   Table has exactly N entries                               â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚           Inverted Page Table            â”‚              â”‚
â”‚   â”‚  Frame â”‚   PID    â”‚  Page Number  â”‚      â”‚              â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚              â”‚
â”‚   â”‚   0    â”‚   P1     â”‚     25        â”‚      â”‚              â”‚
â”‚   â”‚   1    â”‚   P3     â”‚     12        â”‚      â”‚              â”‚
â”‚   â”‚   2    â”‚   P1     â”‚     10        â”‚      â”‚              â”‚
â”‚   â”‚   3    â”‚   P2     â”‚     47        â”‚      â”‚              â”‚
â”‚   â”‚  ...   â”‚  ...     â”‚    ...        â”‚      â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚              â”‚
â”‚                                                             â”‚
â”‚   Search for (pid, page) â†’ Find frame                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Inverted Table Lookup

```c
// Logical Address: (pid, page_number, offset)

int find_frame(int pid, int page) {
    for (int i = 0; i < num_frames; i++) {
        if (table[i].pid == pid && 
            table[i].page == page) {
            return i;  // Frame number
        }
    }
    return -1;  // Page fault
}

// à¦¸à¦®à¦¸à§à¦¯à¦¾: O(n) search time!
// à¦¸à¦®à¦¾à¦§à¦¾à¦¨: Hash table à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‹
```

### Hash + Inverted Page Table

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   Logical Address (pid, page, offset)                       â”‚
â”‚           â”‚                                                 â”‚
â”‚           â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â”‚ Hash(pid,page) â”‚                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚           â”‚                                                 â”‚
â”‚           â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚   â”‚     Hash Table      â”‚                                  â”‚
â”‚   â”‚  (points to frame)  â”‚                                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚   â”‚  Inverted Page Tableâ”‚                                  â”‚
â”‚   â”‚  Verify & get frame â”‚                                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚   Physical Address                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Page Table Structures à¦¤à§à¦²à¦¨à¦¾

| Structure | Space | Time | Use Case |
|-----------|-------|------|----------|
| Single-level | O(pages) | O(1) | Small address space |
| Multi-level | O(used pages) | O(levels) | 32/64-bit general |
| Hashed | O(frames) | O(1) avg | Sparse address space |
| Inverted | O(frames) | O(1) with hash | Memory-constrained |

---

## ğŸ’¡ Real System Examples

### Intel x86-64 (4-level Paging)

```
48-bit Virtual Address:
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PML4â”‚ Dir â”‚ Dir â”‚ Pageâ”‚    Offset    â”‚
â”‚Ptr  â”‚ Ptr â”‚     â”‚Tableâ”‚              â”‚
â”‚9bitsâ”‚9bitsâ”‚9bitsâ”‚9bitsâ”‚   12 bits    â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4 levels of tables
Each level: 512 entries (2^9)
Page size: 4 KB (2^12)
```

### ARM (Multi-level)

```
3 or 4 level page tables
Supports multiple page sizes:
â€¢ 4 KB
â€¢ 16 KB
â€¢ 64 KB
```

---

## ğŸ”§ TLB with Multi-level Tables

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   Without TLB (4-level paging):                             â”‚
â”‚   5 memory accesses per reference!                          â”‚
â”‚   (4 table lookups + 1 actual access)                       â”‚
â”‚                                                             â”‚
â”‚   With TLB:                                                 â”‚
â”‚   â€¢ TLB hit: 1 memory access âœ“                             â”‚
â”‚   â€¢ TLB miss: 5 memory accesses, then cache result          â”‚
â”‚                                                             â”‚
â”‚   TLB Hit Rate 98%:                                         â”‚
â”‚   EAT = 0.98 Ã— 1 + 0.02 Ã— 5 = 1.08 memory accesses         â”‚
â”‚                                                             â”‚
â”‚   TLB is CRITICAL for performance!                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â“ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦ªà§à¦°à¦¶à§à¦¨

**à¦ªà§à¦°à¦¶à§à¦¨ à§§:** Multi-level page table à¦•à§‡à¦¨ à¦¦à¦°à¦•à¦¾à¦°?
**à¦‰à¦¤à§à¦¤à¦°:** à¦¬à¦¡à¦¼ address space à¦ single-level table à¦…à¦¨à§‡à¦• à¦¬à¦¡à¦¼ à¦¹à¦¯à¦¼à§‡ à¦¯à¦¾à¦¯à¦¼à¥¤ Multi-level à¦ à¦¶à§à¦§à§ à¦¬à§à¦¯à¦¬à¦¹à§ƒà¦¤ address range à¦à¦° à¦œà¦¨à§à¦¯ table allocate à¦¹à¦¯à¦¼à¥¤

**à¦ªà§à¦°à¦¶à§à¦¨ à§¨:** Inverted page table à¦ sharing à¦•à¦ à¦¿à¦¨ à¦•à§‡à¦¨?
**à¦‰à¦¤à§à¦¤à¦°:** à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ physical frame à¦à¦•à¦Ÿà¦¿ entry à¦°à¦¾à¦–à§‡à¥¤ à¦à¦•à¦‡ frame à¦¦à§à¦‡ process share à¦•à¦°à¦²à§‡ à¦¦à§à¦‡ entry à¦²à¦¾à¦—à§‡, à¦¯à¦¾ basic structure à¦­à¦¾à¦™à§‡à¥¤

**à¦ªà§à¦°à¦¶à§à¦¨ à§©:** à¦•à§‹à¦¨ page table structure à¦¸à¦¬à¦šà§‡à¦¯à¦¼à§‡ à¦­à¦¾à¦²à§‹?
**à¦‰à¦¤à§à¦¤à¦°:** à¦¨à¦¿à¦°à§à¦­à¦° à¦•à¦°à§‡:
- à¦¸à¦¾à¦§à¦¾à¦°à¦£ use: Multi-level (x86-64)
- Memory-constrained: Inverted (IBM PowerPC)
- Sparse address: Hashed

---
**à¦ªà§‚à¦°à§à¦¬à¦¬à¦°à§à¦¤à§€:** [Segmentation](04-segmentation.md)  
**à¦ªà¦°à¦¬à¦°à§à¦¤à§€ à¦«à§‹à¦²à§à¦¡à¦¾à¦°:** [Virtual Memory](../07-Virtual-Memory/README.md)
